# turn on/off status bar
bind-key -n C-F3 set-option -g status #Ctrl+F3 Combo
unbind C-s
# new and clone of session {{{
bind-key N run-shell 'TMUX= tmux new-session -d \; switch-client -n'
bind-key C run-shell 'TMUX= tmux new-session -t $(tmux display-message -p #S) -s $(tmux display-message -p #S-clone) -d \; switch-client -n \; display-message "session #S cloned"'
#}}}

#-------- Copy Mode (Vim Style) {{{
# This section of hotkeys mainly work in copy mode and no where else

# vim keys in copy or choice mode
set-window-option -g mode-keys vi

# copying selection vim style
# http://jasonwryan.com/blog/2011/06/07/copy-and-paste-in-tmux/
# https://github.com/myfreeweb/dotfiles/blob/master/tmux.conf
bind-key Escape copy-mode                       # enter copy mode; default [
bind-key -t vi-copy Escape cancel               # exit copy mode; or hit q
bind-key -t vi-copy v begin-selection           # begin visual mode
bind-key -t vi-copy V select-line               # visual line
bind-key -t vi-copy y copy-selection            # yank
bind-key -t vi-copy r rectangle-toggle          # visual block toggle
bind-key p paste-buffer                         # paste; default ]
bind-key P choose-buffer                        # choose which buffer to paste from

# read and write and delete paste buffer ( xsel method)
# https://wiki.archlinux.org/index.php/Tmux#ICCCM_Selection_Integration
# ctrl+shift+v
#bind-key < command-prompt -p "copy to tmux (hit enter to confirm):" "run-shell 'tmux set-buffer -- \"$(xsel -o -b)\"'"
#bind-key > command-prompt -p "copy to xsel (hit enter to confirm):" "run-shell 'tmux show-buffer | xsel -i -b'"
# bind-key + command-prompt "delete-buffer"

#}}}
 
# remap prefix to Control + a {{{
set -g prefix C-a
unbind C-b
bind C-a send-prefix
#}}}

# force a reload of the config file {{{
#unbind r
#bind r source-file ~/.tmux.conf \; display-message "Reloaded"

bind-key r source-file ~/.tmux.conf \; display-message "Configuration reloaded"

#}}}

## Переход на окно по F1-F9 {{{
#bind-key F1 select-pane -t 0
#bind-key F2 select-pane -t 1
#bind-key F3 select-pane -t 2
#bind-key -n F4 select-pane -t 3
#bind-key F1 select-window -t 0
#bind-key F2 select-window -t 1
#bind-key F3 select-window -t 2
#bind-key F4 select-window -t 3
#bind-key F5 select-window -t 4
#bind-key F6 select-window -t 5
#bind-key -n F7 select-window -t 6
#bind-key -n F8 select-window -t 7
#bind-key -n F9 select-window -t 8
#}}}

## Клавиатурные сочетания {{{-----------------------------------------------------------------
#
#unbind C-b                                              # "Разбиндинг" префикса по умолчанию
#set -g prefix C-q                                       # Новый префикс для всех комбинаций клавиш - Ctrl-q 
#
## Навигация в командной строке, и в списке окон как в vi
#set -g status-keys vi
#setw -g mode-keys vi 
#
#bind-key -n C-n next                                    # Следующий таб
#bind-key -n C-p prev                                    # Предыдущий таб
#
#bind-key b set-option status                            # Включить\Выключить статус бар
#
#unbind %                                                # Выключаем клавишу для горизонтального разбиения окна по умолчанию
#bind H split-window -h                                  # Назначаем другую
#unbind '"'                                              # Тоже самое, только по вертикали
#bind V split-window -v                                  # ----
#

#bind-key k confirm kill-window                          # Подтверждать уничтожение окна
#bind-key K confirm kill-server                          # Подтверждать уничтожение сервера

# bind-key -n C-S-Up    select-pane -U                      #These keybindings allow you to
# bind-key -n C-S-Down  select-pane -D                      #change the active pane with
# bind-key -n C-S-Left  select-pane -L                      #Ctrl-Shift-ArrowKey
# bind-key -n C-S-Right select-pane -R
#}}}

# vi mode {{{
#bind-key -t vi-copy 'v' begin-selection
#bind-key -t vi-copy 'y' copy-selection
#}}}

# Mouse mode {{{
# Scroll settings{{{
bind-key -T root PPage if-shell -F "#{alternate_on}" "send-keys PPage" "copy-mode -e; send-keys PPage"
bind-key -t vi-copy PPage page-up
bind-key -t vi-copy NPage page-down

bind -T root WheelUpPane if-shell -F -t = "#{alternate_on}" "select-pane -t =; send-keys -M" "select-pane -t =; copy-mode -e; send-keys -M"
bind -T root WheelDownPane if-shell -F -t = "#{alternate_on}" "select-pane -t =; send-keys -M" "select-pane -t =; send-keys -M"
bind-key -t vi-copy WheelUpPane halfpage-up
bind-key -t vi-copy WheelDownPane halfpage-down

set -sg escape-time 0

#scroll mouse
set -g terminal-overrides 'xterm*:smcup@:rmcup@'
#setw -g mouse on
#}}}

# Mouse mode is on by default.
# <prefix> M -- to turn it off
# <prefix> m -- to turn it on
#
# As of tmux 2.1, a backward-incompatible change was introduced.
# mode-mouse and mouse-* no longer exist, replaced by simply
# mouse <on|off>.

if-shell '[[ $(echo "$(tmux -V | cut -d" " -f2) >= 2.1" | bc) -eq 1 ]]' \
    'set -g mode-mouse on; set -g mouse-resize-pane on; set -g mouse-select-pane on; set -g mouse-select-window on; bind m set -g mode-mouse on \; set -g mouse-resize-pane on \; set -g mouse-select-pane on \; set -g mouse-select-window on \; display "Mouse ON"; bind M set -g mode-mouse off \; set -g mouse-resize-pane off \; set -g mouse-select-pane off \; set -g mouse-select-window off \; display "Mouse OFF"' \
    'set -g mouse on; bind m set -g mouse on \; display "Mouse ON"; bind M set -g mouse off \; display "Mouse OFF"' 
#}}}

# Sinc panes {{{
# easily toggle synchronization (mnemonic: e is for echo)
# sends input to all panes in a given window.
bind e setw synchronize-panes on \; display-message "Sinc on"
bind E setw synchronize-panes off \; display-message "Sinc off"
#}}}
